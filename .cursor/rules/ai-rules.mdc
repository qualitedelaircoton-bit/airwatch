---
description: 
globs: 
alwaysApply: true
---
# ü§ñ R√®gles de Collaboration IA

## Principe Fondamental
**RECHERCHER AVANT D'AGIR**. Incertitude = recherche web obligatoire avec "2025".

## üîç M√©thodologie de Recherche

### R√®gle d'Or
> "est ce que c'est pas mieux que si tu identifie un probl√®me, tu la corrige partout avant de continuer?"

**Pattern** : Identifier ‚Üí Rechercher ‚Üí Corriger PARTOUT ‚Üí Tester

### Quand Rechercher (OBLIGATOIRE)
- ‚ùå Incertitude technique
- ‚ùå Erreur inconnue  
- ‚ùå Nouvelle syntaxe/version
- ‚ùå Configuration complexe
- ‚ùå Best practices

### Format Recherche
- **Toujours inclure "2025"** dans les termes
- **Versions exactes** : "Next.js 15.3.3", "Tailwind CSS 4.1.8"
- **Sources** : Docs officielles > GitHub > Stack Overflow

## üõ†Ô∏è Stack & Gestionnaire

### Technologique
- **Next.js 15.3.3** + App Router
- **React 19** + Server Components  
- **TypeScript strict** + `exactOptionalPropertyTypes`
- **Tailwind CSS 4.1.8** (CSS-first)
- **Prisma ORM** + PostgreSQL
- **pnpm** (gestionnaire de packages)

### D√©ploiement
- **Firebase Hosting** (h√©bergement)
- **Neon DB** (PostgreSQL cloud)
- **EMQX Cloud** (MQTT IoT)

## ‚ö° Corrections Syst√©matiques

### TypeScript Strict
```typescript
// API Routes Next.js 15
export async function GET(
  request: Request,
  { params }: { params: Promise<{ id: string }> }
) {
  const { id } = await params;
}

// Imports corrects
import { cva, type VariantProps } from "class-variance-authority";

// Props s√©curis√©es
const isChecked = checked ?? false;
const theme = selectedTheme ?? "system";
```

### Patterns Communs
- **API Routes** : `params` ‚Üí `Promise<{ id: string }>`
- **Pages** : `use()` de React pour params async
- **Environnement** : `process.env.VAR || ""`
- **Props optionnelles** : `value ?? defaultValue`

## üöÄ Configuration

### Variables d'Environnement
```env
# Neon DB
DATABASE_URL="postgresql://user:pass@host/db?sslmode=require"

# EMQX Cloud  
MQTT_BROKER_URL="z166d525.ala.us-east-1.emqxsl.com"
MQTT_PORT="8883"
MQTT_WS_PORT="8084"
MQTT_USERNAME="your_username"
MQTT_PASSWORD="your_password"
```

### Scripts pnpm
```bash
pnpm install        # Installation
pnpm dev           # D√©veloppement
pnpm build         # Build production
pnpm prisma:push   # Base de donn√©es
```

## üìã Processus de Travail

### 1. Identification
- Scanner TOUS les probl√®mes similaires
- Grouper par type/pattern
- Prioriser par impact

### 2. Recherche
- **Obligatoire** pour chaque type de probl√®me
- V√©rifier compatibilit√© versions
- Documenter solutions trouv√©es

### 3. Correction Globale
- Appliquer √† TOUS les fichiers concern√©s
- Batch corrections par type
- √âviter corrections one-by-one

### 4. Validation
- `pnpm build` apr√®s chaque batch
- Tests manuels fonctionnalit√©s critiques
- Documentation des changements

## üéØ R√®gles d'Ex√©cution

### Interdictions
- ‚ùå Corriger un fichier puis tester
- ‚ùå Deviner sans rechercher
- ‚ùå Utiliser `any` ou d√©sactiver types
- ‚ùå R√©f√©rences "2024" (sauf historique)
- ‚ùå Docker (projet Firebase Hosting only)

### Obligations
- ‚úÖ Recherche web syst√©matique
- ‚úÖ Correction globale avant tests
- ‚úÖ Documentation changements
- ‚úÖ TypeScript strict respect√©
- ‚úÖ pnpm comme gestionnaire

## üìù Documentation

### Quelque ressource
1. **MIGRATION_LOG.md** - Journal technique d√©taill√©
2. **README.md** - Documentation projet (Firebase Hosting + Neon + EMQX)
3. **ai-rules.md** - Ce fichier

### √âl√©ments Critiques README
- Installation avec pnpm
- Configuration Neon DB
- EMQX Cloud setup
- API endpoints
- D√©ploiement Firebase Hosting
- **Pas de Docker**

## üîÑ Validation Finale

### Checklist Obligatoire
- [ ] `pnpm build` successful
- [ ] Changements document√©s
- [ ] Fonctionnalit√©s test√©es  
- [ ] Recherches effectu√©es
- [ ] Patterns appliqu√©s globalement

### Flexibilit√© Encadr√©e
- Adapter selon nouveaut√©s 2025
- Questionner si recherche r√©v√®le mieux
- Proposer optimisations research-based
- Maintenir compatibilit√© stack

## üí° M√©mo Final

**Source de v√©rit√©** : Web search avec "2025"
**Philosophie** : Rechercher ‚Üí Comprendre ‚Üí Appliquer partout ‚Üí Tester
**Gestionnaire** : pnpm obligatoire
**D√©ploiement** : Firebase + EMQX Cloud


En cas de doute : **RECHERCHER** üîç 